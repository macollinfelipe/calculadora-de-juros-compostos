<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora de Juros Compostos — Clone</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#f7f8fb;--card:#fff;--accent:#0b67e6;--muted:#6b7280;--glass:rgba(11,103,230,0.08)}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,var(--bg),#eef2ff);padding:24px;color:#0f172a}
    .container{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    header img{width:56px;height:56px;border-radius:8px}
    h1{font-size:20px;margin:0}
    p.lead{margin:6px 0 18px;color:var(--muted)}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(12,22,56,0.06)}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .field{display:flex;flex-direction:column}
    label{font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type=text],select{padding:10px 12px;border-radius:8px;border:1px solid #e6e9f2;font-size:15px}
    .actions{display:flex;gap:8px;align-items:center;margin-top:8px;flex-wrap:wrap}
    button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    .mutebtn{background:transparent;border:1px solid #e6e9f2;color:var(--muted);padding:8px 12px;border-radius:10px}
    .menu-btn{margin-left:auto;background:#14a248;}
    .results{display:flex;gap:12px;margin-top:18px;flex-wrap:wrap}
    .result-card{flex:1;min-width:180px;background:linear-gradient(180deg,rgba(11,103,230,0.04),transparent);padding:12px;border-radius:10px}
    .result-card h3{margin:0;font-size:14px;color:var(--muted)}
    .result-card strong{display:block;font-size:20px;margin-top:6px}
    canvas{max-width:100%;height:320px}
    .breakdown{margin-top:14px}
    table{width:100%;border-collapse:collapse;margin-top:8px}
    th,td{padding:8px;border-bottom:1px solid #f1f5f9;text-align:right;font-size:13px}
    th{text-align:left;color:var(--muted)}
    @media(max-width:820px){.grid{grid-template-columns:1fr}.results{flex-direction:column}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 24 24' fill='none'%3E%3Crect width='24' height='24' rx='6' fill='%230b67e6'/%3E%3Cpath d='M6 15v-6h2v6H6zm4 0V9h2v6h-2zm4 0v-3h2v3h-2z' fill='%23fff'/%3E%3C/svg%3E" alt="logo"/>
      <div>
        <h1>Calculadora de Juros Compostos</h1>
        <p class="lead">Calcule rendimento com capital inicial, aportes periódicos e visualize gráfico e tabela de evolução.</p>
      </div>
    </header>

    <div class="card">
      <div class="grid">
        <div class="field">
          <label for="valorInicial">Valor inicial (R$)</label>
          <input id="valorInicial" type="text" value="1.000" oninput="formatarMoeda(this)">
        </div>
        <div class="field">
          <label for="aporte">Aporte mensal (R$)</label>
          <input id="aporte" type="text" value="1.000" oninput="formatarMoeda(this)">
        </div>
        <div class="field">
          <label for="taxa">Taxa de juros</label>
          <input id="taxa" type="text" value="8" oninput="formatarNumero(this)">
        </div>
        <div class="field">
          <label for="periodo">Período</label>
          <input id="periodo" type="text" value="20" oninput="formatarNumero(this)">
        </div>
        <div class="field">
          <label for="unidade">Unidade da taxa</label>
          <select id="unidade">
            <option value="anual">Anual</option>
            <option value="mensal">Mensal</option>
          </select>
        </div>
        <div class="field">
          <label for="capitalizacao">Capitalização</label>
          <select id="capitalizacao">
            <option value="mensal">Mensal</option>
            <option value="anual">Anual</option>
          </select>
        </div>
      </div>

      <div class="actions">
        <button id="calcular">Calcular</button>
        <button id="limpar" class="mutebtn">Limpar</button>
        <button class="menu-btn" onclick="window.open('https://www.youtube.com/@macollinfelipe','_blank')">Canal Macollin Felipe</button>
        <div style="margin-left:auto;color:var(--muted);font-size:13px">Ex.: R$ 1.000 iniciais, R$1.000/mês, 8% a.a., 20 anos</div>
      </div>

      <div class="results" id="resumo">
        <div class="result-card">
          <h3>Valor investido</h3>
          <strong id="valorInvestido">R$ 0,00</strong>
        </div>
        <div class="result-card">
          <h3>Montante final</h3>
          <strong id="montante">R$ 0,00</strong>
        </div>
        <div class="result-card">
          <h3>Juros ganhos</h3>
          <strong id="juros">R$ 0,00</strong>
        </div>
      </div>

      <div style="margin-top:18px" class="card">
        <canvas id="grafico"></canvas>
      </div>

      <div class="breakdown card" id="tabelaWrap">
        <h3 style="margin:0 0 8px 0">Tabela de evolução</h3>
        <div style="overflow:auto;max-height:320px">
          <table id="tabela">
            <thead>
              <tr><th>Ano</th><th>Saldo</th><th>Aportes</th><th>Juros no ano</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const $ = id => document.getElementById(id);
    const fmt = v => v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});

    function formatarMoeda(el){
      let num = el.value.replace(/[\.]/g,'').replace(/,/g,'.');
      if(isNaN(num)) num='0';
      el.value = parseFloat(num).toLocaleString('pt-BR',{minimumFractionDigits:2,maximumFractionDigits:2});
    }

    function formatarNumero(el){
      el.value = el.value.replace(/[^0-9.]/g,'');
    }

    function parseInput(el){
      return parseFloat(el.value.replace(/[\.]/g,'').replace(/,/g,'.')) || 0;
    }

    function calcular(){
      const C = parseInput($('valorInicial'));
      const aporte = parseInput($('aporte'));
      const taxa = parseInput($('taxa'));
      const periodo = parseInt($('periodo').value) || 0;
      const unidade = $('unidade').value;
      const cap = $('capitalizacao').value;

      let i_periodo;
      if(unidade === 'anual' && cap === 'mensal') i_periodo = Math.pow(1 + taxa/100, 1/12) - 1;
      else if(unidade === 'mensal' && cap === 'anual') i_periodo = Math.pow(1 + taxa/100, 12) - 1;
      else i_periodo = taxa/100;

      let n = cap==='mensal' ? (unidade==='anual'? periodo*12 : periodo) : (unidade==='mensal'? Math.ceil(periodo/12) : periodo);

      const timeline=[];
      let balance = C;
      let totalAportes=0;

      if(cap==='mensal'){
        for(let m=1;m<=n;m++){
          balance = balance*(1+i_periodo)+aporte;
          totalAportes+=aporte;
          if(m%12===0) timeline.push({period:m/12, saldo:balance, aportes:C+totalAportes, juros:balance-(C+totalAportes)});
        }
      } else {
        for(let y=1;y<=n;y++){
          balance = balance*(1+i_periodo)+aporte*12;
          totalAportes+=aporte*12;
          timeline.push({period:y, saldo:balance, aportes:C+totalAportes, juros:balance-(C+totalAportes)});
        }
      }

      $('valorInvestido').textContent = fmt(C + totalAportes);
      $('montante').textContent = fmt(balance);
      $('juros').textContent = fmt(balance - (C + totalAportes));

      const tbody = document.querySelector('#tabela tbody');
      tbody.innerHTML='';
      timeline.forEach(row=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td style='text-align:left'>${row.period}</td><td>${fmt(row.saldo)}</td><td>${fmt(row.aportes)}</td><td>${fmt(row.juros)}</td>`;
        tbody.appendChild(tr);
      });

      renderChart(timeline.map(r=>r.period+' anos'), timeline.map(r=>r.saldo));
    }

    let chart=null;
    function renderChart(labels,data){
      const ctx = document.getElementById('grafico');
      if(chart) chart.destroy();
      chart = new Chart(ctx,{type:'line', data:{labels,datasets:[{label:'Saldo acumulado',data,fill:true,tension:0.3}]}, options:{responsive:true,scales:{y:{beginAtZero:true,ticks:{callback:v=>v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'})}}}}});
    }

    document.getElementById('calcular').addEventListener('click',calcular);
    document.getElementById('limpar').addEventListener('click',()=>{
      document.querySelectorAll('input[type=text]').forEach(i=>i.value='');
      document.querySelector('#tabela tbody').innerHTML='';
      if(chart) chart.destroy();
      $('valorInvestido').textContent='R$ 0,00';
      $('montante').textContent='R$ 0,00';
      $('juros').textContent='R$ 0,00';
    });

    calcular();
  </script>
</body>
</html>
